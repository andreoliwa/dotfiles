- name: "Install apt packages (configured by YAML files under the group_vars/ dir)"
  apt: name="{{ apt_packages }}" state=present
  become: true
  when:
    - server_type in ["pi", "ocean", "hetzner"]
    - "'apt_packages' | run_only_after"

- import_tasks: osmc.yml
  when: server_type in ["pi"]

- import_tasks: pipx.yml
  when: server_type in ["pi"]

- import_tasks: video_subtitles.yml
  when: server_type in ["pi"]

- name: "Create ~/OneDrive/Backup"
  file:
    state: directory
    path: ~/OneDrive/Backup
    mode: 0644
  when: server_type in ["aws", "ocean", "hetzner"]

- name: Clone container-apps
  git:
    repo: https://github.com/andreoliwa/container-apps
    version: master
    dest: ~/container-apps
    clone: yes
    update: yes
  when: server_type in ["aws", "ocean", "hetzner"]

- name: Clone container-apps-private
  git:
    repo: git@github.com:andreoliwa/container-apps-private.git
    version: master
    dest: ~/container-apps-private
    clone: yes
    update: yes
  when: server_type in ["pi"]
